<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel de Sensores</title>
    <style>
        body { font-family: Arial; background: #f9f9f9; padding: 20px; }
        .sensor { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 0 5px rgba(0,0,0,0.1); width: 300px; }
        .valor { font-size: 1.5em; color: #007bff; }
    </style>
</head>
<body>
    <h1>📡 Datos del Sensor en Tiempo Real</h1>
    <div class="sensor">
        <p>Nivel: <span id="nivel" class="valor">--</span></p>
        <p>Humedad: <span id="humedad" class="valor">--</span></p>
    </div>

    <script>
        const ws = new WebSocket("ws://" + window.location.host + "/ws/sensores/");
        const nivel = document.getElementById("nivel");
        const humedad = document.getElementById("humedad");

        ws.onopen = () => console.log("🟢 WebSocket conectado.");
        ws.onclose = () => console.log("🔴 WebSocket desconectado.");
        ws.onerror = (err) => console.error("⚠️ Error:", err);

        // cuando el servidor manda datos
        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            nivel.textContent = data.nivel;
            humedad.textContent = data.humedad;
        };

        // Simulación de envío de datos (como si fuera un sensor)
        setInterval(() => {
            const fakeData = {
                nivel: Math.floor(Math.random() * 100),
                humedad: Math.floor(Math.random() * 100)
            };
            ws.send(JSON.stringify(fakeData));
        }, 2000);
    </script>
</body>
</html>
